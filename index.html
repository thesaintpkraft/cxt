<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAN 2026 | LIVE STATUS</title>
    
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>

    <style>
        :root { --primary: #00ffcc; --bg: #0f172a; --card: #1e293b; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--bg); color: white; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        
        .status-bar { font-size: 0.8rem; padding: 5px 15px; border-radius: 20px; background: #1e293b; margin-bottom: 20px; color: var(--primary); border: 1px solid #334155; }

        .drop-zone { 
            width: 100%; max-width: 600px; min-height: 250px; margin-bottom: 40px; padding: 20px; 
            border: 3px dashed #334155; border-radius: 20px; background: rgba(30, 41, 59, 0.8); 
            text-align: center; display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        .drop-zone.hover { border-color: var(--primary); background: rgba(0, 255, 204, 0.1); }
        
        #activeContent img { max-width: 100%; height: 200px; border-radius: 10px; border: 2px solid var(--primary); object-fit: contain; }
        #activeContent h3 { font-size: 2rem; color: var(--primary); margin: 15px 0 0; }

        .grid { 
            display: grid; 
            grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); 
            gap: 20px; 
            width: 100%; 
            max-width: 1200px;
            padding-bottom: 50px;
        }

        .card { 
            background: var(--card); border-radius: 12px; overflow: hidden; cursor: grab; 
            border: 1px solid #334155; transition: 0.2s; display: flex; flex-direction: column; 
        }
        .card:hover { border-color: var(--primary); transform: translateY(-5px); }
        .card img { width: 100%; height: 180px; object-fit: cover; pointer-events: none; background: #000; }
        .card-title { padding: 10px; font-size: 0.85rem; font-weight: bold; text-align: center; background: #1c2641; min-height: 40px; display: flex; align-items: center; justify-content: center; }
        
        /* Falls ein Bild fehlt */
        img:error { border: 2px solid red; }
    </style>
</head>
<body>

    <div class="status-bar" id="syncStatus">Initialisiere...</div>

    <div class="drop-zone" id="dropZone">
        <h2 style="color:var(--primary); margin-top:0; font-size: 1rem; letter-spacing: 2px;">AKTUELL AKTIV</h2>
        <div id="activeContent">
            <p style="color:#475569">Warte auf Daten...</p>
        </div>
    </div>

    <div class="grid" id="gameGrid"></div>

    <script>
        // Deine Firebase Konfiguration
        const firebaseConfig = {
            apiKey: "AIzaSyA9VdTsTAKpf0F3C_E8PKiYEIV_gsKvq70",
            authDomain: "lan-party-dd5e6.firebaseapp.com",
            databaseURL: "https://lan-party-dd5e6-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "lan-party-dd5e6",
            storageBucket: "lan-party-dd5e6.firebasestorage.app",
            messagingSenderId: "1070535216863",
            appId: "1:1070535216863:web:3052c02bea67dc2881636a"
        };

        // Firebase Start
        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();
        const gameRef = database.ref('current_game');

        // Deine exakte Dateiliste von GitHub
        const games = [
            { title: "The Finals", img: "img/thefinals.jpg" },
            { title: "Warcraft 3", img: "img/Warcraft_3_logo.jpg" },
            { title: "CS 1.6", img: "img/cs16.jpg" },
            { title: "Quake 3", img: "img/Quake_III_Arena_Logo.svg.png" },
            { title: "Flatout 2", img: "img/Flatout2pc.jpg" },
            { title: "World War Z", img: "img/World_War_Z_cover_art.jpg" },
            { title: "Trackmania", img: "img/Cover_of_Trackmania.jpg" },
            { title: "Serious Sam 2", img: "img/Serious_Sam_II.jpg" },
            { title: "Blobby Volley", img: "img/Blobby-volley-logo.png" },
            { title: "C&C 3", img: "img/Command_&_Conquer_Tiberium_Wars_Logo.jpg" },
            { title: "Dead Island 2", img: "img/Dead_Island_2_cover_art.jpg" },
            { title: "BF Vietnam", img: "img/Battlefield_Vietnam_Coverart.png" },
            { title: "Dead by Daylight", img: "img/Dead_by_Daylight_Logo.png" },
            { title: "Northgard", img: "img/Northgard_cover_art.jpg" }
        ];

        const grid = document.getElementById('gameGrid');
        const dropZone = document.getElementById('dropZone');
        const statusDisplay = document.getElementById('syncStatus');

        function renderPool() {
            grid.innerHTML = '';
            games.forEach(game => {
                const card = document.createElement('div');
                card.className = 'card';
                card.draggable = true;
                // WICHTIG: onerror falls Pfad doch falsch ist
                card.innerHTML = `
                    <img src="${game.img}" onerror="this.src='https://via.placeholder.com/150x200?text=Fehler'">
                    <div class="card-title">${game.title}</div>
                `;
                card.addEventListener('dragstart', (e) => {
                    e.dataTransfer.setData('application/json', JSON.stringify(game));
                });
                grid.appendChild(card);
            });
        }

        // Drag & Drop
        dropZone.addEventListener('dragover', (e) => { e.preventDefault(); dropZone.classList.add('hover'); });
        dropZone.addEventListener('dragleave', () => dropZone.classList.remove('hover'));
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('hover');
            try {
                const data = JSON.parse(e.dataTransfer.getData('application/json'));
                gameRef.set(data);
            } catch(err) { console.error("Drop Error", err); }
        });

        // Sync Logik
        gameRef.on('value', (snapshot) => {
            const data = snapshot.val();
            if(data) {
                document.getElementById('activeContent').innerHTML = `
                    <img src="${data.img}" style="animation: fadeIn 0.5s;">
                    <h3>${data.title}</h3>
                `;
                statusDisplay.innerText = "Live: " + data.title;
            } else {
                statusDisplay.innerText = "Verbunden. Zieh ein Spiel hoch!";
            }
        });

        // Start
        window.onload = renderPool;
    </script>

    <style>
        @keyframes fadeIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    </style>
</body>
</html>
